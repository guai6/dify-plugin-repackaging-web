import{d as J,v as f,a6 as K,c as v,b as e,h as X,a7 as $,M as j,w as l,y as G,K as H,X as P,$ as Q,a8 as Y,a9 as Z,a as s,E as ee,e as F,f as i,B as le,F as ae,r as oe,C as te,a4 as ne,g as se,I as re,J as ie,t as _,q as w,S as b,o as x,_ as ue}from"./index-BrQRFijk.js";/* empty css                 *//* empty css                             *//* empty css                     *//* empty css               *//* empty css                  *//* empty css               *//* empty css                    */import{a as de,b as fe}from"./index-CqoqUkBq.js";/* empty css                   */const _e={class:"local-form"},me={key:0,class:"file-info"},pe=J({__name:"LocalForm",emits:["submit"],setup(ce,{emit:C}){const V=C,S=f(),m=f(),p=f(!1),o=f(null),n=K({platform:"",suffix:"offline"}),B=[{label:"Linux x86_64",value:"manylinux2014_x86_64"},{label:"Linux aarch64",value:"manylinux2014_aarch64"},{label:"Windows x86_64",value:"win_amd64"},{label:"macOS x86_64",value:"macosx_10_9_x86_64"},{label:"macOS arm64",value:"macosx_11_0_arm64"}],U=t=>{t.raw&&(o.value=t.raw)},M=()=>{o.value=null},z=t=>{if(!t.name.endsWith(".difypkg"))return b.error("只能上传 .difypkg 文件"),!1;const a=500*1024*1024;return t.size>a?(b.error("文件大小不能超过 500MB"),!1):(o.value=t,!1)},y=async()=>{if(!o.value){b.error("请先选择要上传的文件");return}p.value=!0;try{const t={file:o.value,platform:n.platform||void 0,suffix:n.suffix||"offline"};V("submit",t)}catch(t){console.error("提交失败:",t)}finally{p.value=!1}},I=()=>{m.value&&m.value.clearFiles(),o.value=null,n.platform="",n.suffix="offline"};return(t,a)=>{const L=F("UploadFilled"),g=ee,R=Z,u=Y,c=Q,E=P,h=te,D=le,N=ne,O=F("Upload"),k=se,q=$,d=ie,T=re,W=G,A=H;return x(),v("div",_e,[e(q,{ref_key:"formRef",ref:S,model:n,"label-width":"120px",onSubmit:j(y,["prevent"])},{default:l(()=>[e(E,{gutter:24},{default:l(()=>[e(c,{span:24},{default:l(()=>[e(u,{label:"上传文件",required:""},{default:l(()=>[e(R,{ref_key:"uploadRef",ref:m,class:"upload-dragger",drag:"","auto-upload":!1,"show-file-list":!0,limit:1,accept:".difypkg","on-change":U,"on-remove":M,"before-upload":z},{tip:l(()=>a[2]||(a[2]=[s("div",{class:"el-upload__tip"}," 只能上传 .difypkg 文件，且不超过 500MB ",-1)])),default:l(()=>[e(g,{class:"el-icon--upload"},{default:l(()=>[e(L)]),_:1}),a[3]||(a[3]=s("div",{class:"el-upload__text"},[i(" 将 .difypkg 文件拖到此处，或"),s("em",null,"点击上传")],-1))]),_:1,__:[3]},512)]),_:1})]),_:1})]),_:1}),e(E,{gutter:24},{default:l(()=>[e(c,{span:12},{default:l(()=>[e(u,{label:"目标平台"},{default:l(()=>[e(D,{modelValue:n.platform,"onUpdate:modelValue":a[0]||(a[0]=r=>n.platform=r),placeholder:"选择目标平台（可选）",clearable:"",style:{width:"100%"}},{default:l(()=>[(x(),v(ae,null,oe(B,r=>e(h,{key:r.value,label:r.label,value:r.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(u,{label:"包后缀"},{default:l(()=>[e(N,{modelValue:n.suffix,"onUpdate:modelValue":a[1]||(a[1]=r=>n.suffix=r),placeholder:"默认: offline"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(u,null,{default:l(()=>[e(k,{type:"primary",onClick:y,loading:p.value,disabled:!o.value,size:"large"},{default:l(()=>[e(g,null,{default:l(()=>[e(O)]),_:1}),a[4]||(a[4]=i(" 上传并重新打包 "))]),_:1,__:[4]},8,["loading","disabled"]),e(k,{onClick:I,size:"large"},{default:l(()=>a[5]||(a[5]=[i(" 重置 ")])),_:1,__:[5]})]),_:1})]),_:1},8,["model"]),o.value?(x(),v("div",me,[e(W,null,{header:l(()=>a[6]||(a[6]=[s("span",null,"文件信息",-1)])),default:l(()=>[e(T,{column:2,border:""},{default:l(()=>[e(d,{label:"文件名"},{default:l(()=>[i(_(o.value.name),1)]),_:1}),e(d,{label:"文件大小"},{default:l(()=>[i(_(w(de)(o.value.size)),1)]),_:1}),e(d,{label:"文件类型"},{default:l(()=>[i(_(o.value.type||"application/octet-stream"),1)]),_:1}),e(d,{label:"最后修改"},{default:l(()=>[i(_(w(fe)(o.value.lastModified)),1)]),_:1})]),_:1})]),_:1})])):X("",!0),e(A,{title:"说明",type:"info",closable:!1,class:"info-alert"},{default:l(()=>a[7]||(a[7]=[s("div",{class:"info-content"},[s("p",null,"• 支持上传 .difypkg 格式的Dify插件文件"),s("p",null,"• 文件大小限制为 500MB"),s("p",null,"• 上传成功后将自动开始重新打包过程"),s("p",null,"• 可选择目标平台进行跨平台打包")],-1)])),_:1})])}}}),Ve=ue(pe,[["__scopeId","data-v-befc35d2"]]);export{Ve as L};
