import{d as U,k as X,l as j,v as A,m as g,p as G,c as u,b as e,w as a,X as H,$ as J,y as K,a as s,t as r,E as O,e as v,a0 as Q,F as W,r as Y,z as Z,f as S,q as o,s as ss,g as ts,h as w,u as es,o as _,_ as as}from"./index-BrQRFijk.js";/* empty css                    *//* empty css               *//* empty css                 *//* empty css               *//* empty css                             */import{g as os,f as b,a as E}from"./index-CqoqUkBq.js";import{L as ns}from"./LocalForm-Ch7Uczql.js";/* empty css                 *//* empty css                     *//* empty css                  *//* empty css                   */const ls={class:"dashboard"},rs={class:"stat-content"},cs={class:"stat-value"},is={class:"stat-icon"},ds={class:"stat-content"},us={class:"stat-value active"},_s={class:"stat-icon active"},ps={class:"stat-content"},ms={class:"stat-value success"},fs={class:"stat-icon success"},gs={class:"stat-content"},vs={class:"stat-value error"},ys={class:"stat-icon error"},hs={class:"card-header"},ks={key:0,class:"empty-state"},Ss={key:1,class:"task-list"},bs={class:"task-info"},Cs={class:"task-title"},Ts={class:"task-status"},ws={class:"task-step"},Es={class:"task-progress"},xs={class:"card-header"},$s={key:0,class:"system-status"},Is={class:"status-item"},Ls={class:"status-value"},Ps={class:"status-item"},Ds={class:"status-value"},Fs={class:"status-item"},zs={class:"status-value"},Bs={key:0,class:"storage-info"},Ns={class:"storage-item"},Vs={class:"storage-value"},Rs={class:"storage-item"},Ms={class:"storage-value"},qs={class:"storage-item"},Us={class:"storage-value"},Xs={class:"storage-item"},js={class:"storage-value"},As=U({__name:"Dashboard",setup(Gs){const x=es(),p=X(),n=j();A("market");const $=g(()=>p.totalTasks),y=g(()=>p.activeTasks),I=g(()=>p.completedTasks),L=g(()=>p.failedTasks),P=async l=>{const t=await p.uploadFile(l.file,l.platform,l.suffix);t&&x.push(`/tasks/${t.task_id}`)},D=l=>{const t=l.parameters||{};return l.mode==="market"?`${t.author}/${t.name} v${t.version}`:l.mode==="github"?`${t.repo} ${t.release}`:l.mode==="local"?t.file_name||"本地文件":"未知任务"},F=l=>({pending:"",downloading:"warning",extracting:"warning",packaging:"warning",completed:"success",failed:"danger",cancelled:"info"})[l]||"",z=l=>{if(l==="completed")return"success";if(l==="failed")return"exception"},h=l=>l<60?"#67c23a":l<80?"#e6a23c":"#f56c6c",C=async()=>{await Promise.all([n.fetchSystemStatus(),n.fetchStorageInfo()])};return G(async()=>{await Promise.all([p.fetchTasks({limit:10}),C()])}),(l,t)=>{const c=K,d=J,k=H,B=v("Document"),m=O,N=v("Loading"),V=v("CircleCheck"),R=v("CircleClose"),T=ts,M=Q,q=Z,f=ss;return _(),u("div",ls,[e(k,{gutter:24,class:"create-task-section"},{default:a(()=>[e(d,{span:24},{default:a(()=>[e(c,null,{header:a(()=>t[1]||(t[1]=[s("div",{class:"card-header"},[s("span",null,"创建新任务")],-1)])),default:a(()=>[e(ns,{onSubmit:P})]),_:1})]),_:1})]),_:1}),e(k,{gutter:24,class:"stats-section"},{default:a(()=>[e(d,{span:6},{default:a(()=>[e(c,{class:"stat-card"},{default:a(()=>[s("div",rs,[s("div",cs,r($.value),1),t[2]||(t[2]=s("div",{class:"stat-label"},"总任务数",-1))]),s("div",is,[e(m,null,{default:a(()=>[e(B)]),_:1})])]),_:1})]),_:1}),e(d,{span:6},{default:a(()=>[e(c,{class:"stat-card"},{default:a(()=>[s("div",ds,[s("div",us,r(y.value.length),1),t[3]||(t[3]=s("div",{class:"stat-label"},"进行中",-1))]),s("div",_s,[e(m,null,{default:a(()=>[e(N)]),_:1})])]),_:1})]),_:1}),e(d,{span:6},{default:a(()=>[e(c,{class:"stat-card"},{default:a(()=>[s("div",ps,[s("div",ms,r(I.value.length),1),t[4]||(t[4]=s("div",{class:"stat-label"},"已完成",-1))]),s("div",fs,[e(m,null,{default:a(()=>[e(V)]),_:1})])]),_:1})]),_:1}),e(d,{span:6},{default:a(()=>[e(c,{class:"stat-card"},{default:a(()=>[s("div",gs,[s("div",vs,r(L.value.length),1),t[5]||(t[5]=s("div",{class:"stat-label"},"失败",-1))]),s("div",ys,[e(m,null,{default:a(()=>[e(R)]),_:1})])]),_:1})]),_:1})]),_:1}),e(k,{gutter:24,class:"content-section"},{default:a(()=>[e(d,{span:16},{default:a(()=>[e(c,null,{header:a(()=>[s("div",hs,[t[7]||(t[7]=s("span",null,"活跃任务",-1)),e(T,{type:"primary",size:"small",onClick:t[0]||(t[0]=i=>l.$router.push("/tasks"))},{default:a(()=>t[6]||(t[6]=[S(" 查看全部 ")])),_:1,__:[6]})])]),default:a(()=>[y.value.length===0?(_(),u("div",ks,[e(M,{description:"暂无活跃任务"})])):(_(),u("div",Ss,[(_(!0),u(W,null,Y(y.value.slice(0,5),i=>(_(),u("div",{key:i.task_id,class:"task-item"},[s("div",bs,[s("div",Cs,r(D(i)),1),s("div",Ts,[e(q,{type:F(i.status)},{default:a(()=>[S(r(o(os)(i.status)),1)]),_:2},1032,["type"]),s("span",ws,r(i.current_step||"等待中..."),1)])]),s("div",Es,[e(f,{percentage:Math.round(i.progress*100),status:z(i.status)},null,8,["percentage","status"])])]))),128))]))]),_:1})]),_:1}),e(d,{span:8},{default:a(()=>[e(c,{class:"system-status-card"},{header:a(()=>[s("div",xs,[t[9]||(t[9]=s("span",null,"系统状态",-1)),e(T,{size:"small",onClick:C,loading:o(n).loading},{default:a(()=>t[8]||(t[8]=[S(" 刷新 ")])),_:1,__:[8]},8,["loading"])])]),default:a(()=>[o(n).systemStatus?(_(),u("div",$s,[s("div",Is,[t[10]||(t[10]=s("span",{class:"status-label"},"CPU使用率",-1)),e(f,{percentage:o(n).systemStatus.cpu_percent,color:h(o(n).systemStatus.cpu_percent),"show-text":!1,class:"status-progress"},null,8,["percentage","color"]),s("span",Ls,r(o(b)(o(n).systemStatus.cpu_percent)),1)]),s("div",Ps,[t[11]||(t[11]=s("span",{class:"status-label"},"内存使用率",-1)),e(f,{percentage:o(n).systemStatus.memory_percent,color:h(o(n).systemStatus.memory_percent),"show-text":!1,class:"status-progress"},null,8,["percentage","color"]),s("span",Ds,r(o(b)(o(n).systemStatus.memory_percent)),1)]),s("div",Fs,[t[12]||(t[12]=s("span",{class:"status-label"},"磁盘使用率",-1)),e(f,{percentage:o(n).systemStatus.disk_percent,color:h(o(n).systemStatus.disk_percent),"show-text":!1,class:"status-progress"},null,8,["percentage","color"]),s("span",zs,r(o(b)(o(n).systemStatus.disk_percent)),1)])])):w("",!0)]),_:1}),e(c,{class:"storage-info-card"},{header:a(()=>t[13]||(t[13]=[s("div",{class:"card-header"},[s("span",null,"存储信息")],-1)])),default:a(()=>[o(n).storageInfo?(_(),u("div",Bs,[s("div",Ns,[t[14]||(t[14]=s("span",{class:"storage-label"},"已用空间",-1)),s("span",Vs,r(o(E)(o(n).storageInfo.used_space)),1)]),s("div",Rs,[t[15]||(t[15]=s("span",{class:"storage-label"},"总空间",-1)),s("span",Ms,r(o(E)(o(n).storageInfo.total_space)),1)]),s("div",qs,[t[16]||(t[16]=s("span",{class:"storage-label"},"上传文件",-1)),s("span",Us,r(o(n).storageInfo.upload_count)+" 个 ",1)]),s("div",Xs,[t[17]||(t[17]=s("span",{class:"storage-label"},"输出文件",-1)),s("span",js,r(o(n).storageInfo.output_count)+" 个 ",1)])])):w("",!0)]),_:1})]),_:1})]),_:1})])}}}),ot=as(As,[["__scopeId","data-v-275c3138"]]);export{ot as default};
